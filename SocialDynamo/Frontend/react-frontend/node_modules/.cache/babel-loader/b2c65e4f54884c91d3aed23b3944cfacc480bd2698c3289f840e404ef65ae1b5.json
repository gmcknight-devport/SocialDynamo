{"ast":null,"code":"var _jsxFileName = \"D:\\\\Glenn McKnight\\\\Documents\\\\Github\\\\SocialDynamo\\\\SocialDynamo\\\\Frontend\\\\react-frontend\\\\src\\\\components\\\\post\\\\post.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport \"./post.css\";\n//import \"./files.css\";\nimport CommentsPopup from \"../modals/comments-popup\";\nimport UserPopup from \"../modals/user-popup\";\nimport UserProfileHeader from \"../user-profile-header\";\nimport BlobToImage from \"../../util/blob-to-image\";\nimport ImageCarousel from \"./image-carousel\";\n//import \"react-image-gallery/styles/css/image-gallery.css\";\nimport \"./image-gallery.css\";\nimport ImageGallery from \"react-image-gallery\";\nimport styled from 'styled-components';\nimport ArrowCircleLeftIcon from '@mui/icons-material/ArrowCircleLeft';\nimport ArrowCircleRightIcon from '@mui/icons-material/ArrowCircleRight';\nimport FavoriteBorderIcon from \"@mui/icons-material/FavoriteBorder\";\nimport { formControlLabelClasses } from \"@mui/material\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Post(_ref) {\n  _s();\n  let {\n    post\n  } = _ref;\n  const [userLiked, setUserLiked] = useState(false);\n  const [likes, setLikes] = useState(post.Likes.length > 0 ? post.Likes : 0);\n  const [hasMultipleFiles, setHasMultipleFiles] = useState(false);\n  const maxHeight = \"800px\";\n  const maxWidth = \"400px\";\n\n  // const images = BlobToImage({ byteArray: post.Files });\n\n  // const largestImageHeight = Math.min(\n  //   images.length > 0 ? Math.max(...images.map(image => image.height)) : 600,\n  //   600\n  // );\n  const [images, setImages] = useState([]);\n  const [largestImageHeight, setLargestImageHeight] = useState(maxHeight);\n  const userRow = {\n    profilepictureblob: post.ProfilePicture,\n    name: post.UsersName,\n    userid: post.UserId\n  };\n  let debounceTimeout;\n  console.log(`maxWidth: ${maxWidth}, maxHeight: ${maxHeight}, height: ${largestImageHeight}`);\n\n  //Loop through once loaded. \n  //Don't think it will work due to images not being loaded, still urls. \n\n  //Set css based on code values\n  // const ImageContainer = styled.div`\n\n  //   .image-gallery-content,\n  //   .image-gallery-image,\n  //   .image-gallery-slides\n  //   {\n  //     width: 100%;\n  //     max-width: ${maxWidth}px;\n  //     height: ${largestImageHeight}px;\n  //     max-height: ${maxHeight}px;\n  //     object-fit: contain;\n  //   }\n\n  //   .image-gallery-slides{\n  //     border: 1px solid black\n  //   }\n  //   `;\n\n  const [ImageContainer, setImageContainer] = useState(null);\n\n  //Initialise multiple files const\n  useEffect(() => {\n    setHasMultipleFiles(post.Files.length > 1);\n\n    // const blobResult = BlobToImage({ byteArray: post.Files });\n\n    // console.log(\"Just checking blobResult after fetching: \" + blobResult);\n\n    // setImages(blobResult);\n    // const maxImageHeight = Math.max(...images.map(image => image.height));\n\n    // console.log(\"Just checking height after maxImageHeight: \" + maxImageHeight);\n\n    // if (maxImageHeight >= parseInt(maxHeight)) {\n    //   setLargestImageHeight(parseInt(maxHeight));\n    // }else{\n    //   setLargestImageHeight(`${maxImageHeight}px`);\n    // }\n\n    //console.log(\"Just checking height before blob stuff: \" + images[0].height);\n\n    const fetchImages = async () => {\n      // const result = await BlobToImage({ byteArray: post.Files });\n      // setImages(result);\n      try {\n        const result = await BlobToImage({\n          byteArray: post.Files\n        });\n        console.log('Fetched images successfully:', result);\n        setImages(result);\n      } catch (error) {\n        console.error('Error fetching images:', error);\n        setImages([]); // Ensure that images are set to an empty array in case of an error\n      }\n    };\n\n    fetchImages();\n\n    // console.log(`Max height in useEffect (should be 400px): ${maxHeight}`);\n\n    // const largestImage = () => {\n    //   // const result = Math.min(\n    //   //   images.length > 0 ? Math.max(...images.map(image => image.height)) : 0,\n    //   //   parseInt(maxHeight));\n\n    //   // if (images.length > 0) {\n    //   //   const maxCollectionHeight = Math.max(...images.map(image => image.height));\n    //   //   result = maxCollectionHeight <= parseInt(maxHeight) ? maxCollectionHeight : parseInt(maxHeight);\n    //   // } else {\n    //   //   result = parseInt(maxHeight);\n    //   // }\n\n    //   // console.log(`Max height is: ${result}`);\n    //   // setLargestImageHeight(result);\n\n    //   console.log(`Images length: ${images.length}`);\n\n    //   if (images.length > 0) {\n    //     const maxImageHeight = Math.max(...images.map(image => image.height));\n\n    //     if (maxImageHeight <= parseInt(maxHeight)) {\n    //       console.log(`Setting height to actual image height: ${maxImageHeight}`);\n    //       setLargestImageHeight(`${maxImageHeight}px`);\n    //     } else {\n    //       console.log(`Setting height to maxHeight: ${maxHeight}`);\n    //       setLargestImageHeight(maxHeight);\n    //     }\n    //   } else {\n    //     console.log(`Setting height to default maxHeight: ${maxHeight}`);\n    //     setLargestImageHeight(maxHeight);\n    //   }\n    // };\n\n    // //largestImage();\n\n    // const fetchDataAndCalculate = () => {\n    //   console.log(\"In new fetch method, images.length: \" + images.length);\n    //   fetchImages();\n    //   largestImage();\n    // };\n\n    // fetchDataAndCalculate();\n  }, [post.Files.length]);\n  useEffect(() => {\n    // const maxImageHeight = Math.max(...images.map(image => image.height));\n\n    // if (maxImageHeight <= parseInt(maxHeight)) {\n    //   setLargestImageHeight(`${maxImageHeight}px`);\n    // } else {\n    //   setLargestImageHeight(maxHeight);\n    // }\n\n    const adjustedHeights = images.map(image => {\n      const aspectRatio = image.width / image.height;\n      const adjustedHeight = Math.min(maxWidth / aspectRatio, parseInt(maxHeight));\n      return Math.min(adjustedHeight, parseInt(maxHeight));\n    });\n\n    // Find the maximum adjusted height among all images\n    const maxAdjustedHeight = Math.max(...adjustedHeights);\n    setLargestImageHeight(`${maxAdjustedHeight}px`);\n    console.log(\"HERE largest final image height: \" + maxAdjustedHeight);\n\n    //Set\n    const imgCont = styled.div`    \n        .image-gallery-content,\n        .image-gallery-image,\n        .image-gallery-slides\n        {\n          width: 100%;\n          max-width: ${maxWidth}px;\n          height: ${maxImageHeight}px;\n          max-height: ${maxHeight}px;\n          object-fit: contain;\n        }\n        \n        .image-gallery-slides{\n          border: 1px solid black\n        }\n        `;\n    setImageContainer(imgCont);\n  }, [images]);\n\n  //Handle post like\n  const handleLikeClick = () => {\n    setUserLiked(!userLiked);\n\n    // Update the local state of likes\n    const newLikes = userLiked ? likes - 1 : likes + 1;\n    setLikes(newLikes);\n    if (debounceTimeout) {\n      clearTimeout(debounceTimeout);\n    }\n    debounceTimeout = setTimeout(async () => {\n      var _JSON$parse;\n      const postId = post.postId;\n      const likeUserId = ((_JSON$parse = JSON.parse(sessionStorage.getItem('userId'))) === null || _JSON$parse === void 0 ? void 0 : _JSON$parse.UserId) || null;\n      const objMap = {\n        postId,\n        likeUserId\n      };\n      const finalBody = JSON.stringify(objMap);\n\n      //Send data\n      const response = await fetch('http://20.49.168.20:80/posts/likepost', {\n        method: 'PUT',\n        body: finalBody,\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n    }, 300);\n  };\n\n  //Fetch current likes from API\n  const fetchPostLikes = async () => {\n    // const userIds = post.likes.map((like) => like.LikeUserId);\n\n    // const objMap = { userIds };\n    // const finalBody = JSON.stringify(objMap);\n\n    // //Send data              \n    // const response = await fetch('http://20.49.168.20:80/account/Profiles', {\n    //   method: 'PUT',\n    //   body: finalBody,\n    //   headers: {\n    //     'Content-Type': 'application/json',\n    //   },\n    // });\n\n    // const data = await response.json();\n\n    // //Map response and update\n    // const processedData = post.likes.map((item, index) => ({\n    //   userId: item.LikeUserId,\n    //   name: data[index].forename + ' ' + data[index].surname,\n    //   profilePictureBlob: data[index].profilePictureBlob\n    // }));      \n\n    // if(userLiked) processedData.unshift(userRow);\n\n    // return processedData;\n    const testLikesData = [{\n      userId: 1,\n      name: 'John Doe',\n      profilePictureBlob: null\n    }, {\n      userId: 2,\n      name: 'Jane Smith',\n      profilePictureBlob: null\n    }, {\n      userId: 3,\n      name: 'Bob Johnson',\n      profilePictureBlob: null\n    }];\n    return testLikesData;\n  };\n  console.log(images);\n\n  //  //\n  //Set max height and max width with !important?\n  //Set width with !important?\n  //  Might not need to since the div wraps both the gallery and the single image. \n  //All width should be constant. \n  //Should resize images to this width, mainaining aspect ratio, maybe in blob-to-image\n  //Remember to set background\n\n  //  //\n  //Ensure image is centred. \n\n  //  //\n  //Could try only defining width, should maintain aspect ratio of height. \n  //Will just need to set height to maximum image size. \n  //Scale everything else up to fit width\n\n  //  //\n  //Could just scale everything to fit the biggest height inside 598px? \n  //\n\n  //\n  // Could scale everything up within 50 - 100px?\n  //\n\n  //Custom rendering for left nav icon\n  function renderLeftNav(onClick, disabled) {\n    return /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"image-gallery-left-nav\",\n      disabled: disabled,\n      onClick: onClick,\n      children: /*#__PURE__*/_jsxDEV(ArrowCircleLeftIcon, {\n        className: \"LeftIcon\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 7\n    }, this);\n  }\n  ;\n\n  //Custom render for right nav icon\n  function renderRightNav(onClick, disabled) {\n    return /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"image-gallery-right-nav\",\n      disabled: disabled,\n      onClick: onClick,\n      children: /*#__PURE__*/_jsxDEV(ArrowCircleRightIcon, {\n        className: \"RightIcon\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 7\n    }, this);\n  }\n  console.log(\"Has multiple files: \" + hasMultipleFiles);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"post\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"post-header\",\n      children: /*#__PURE__*/_jsxDEV(UserProfileHeader, {\n        profilepictureblob: post.ProfilePicture,\n        name: post.UsersName,\n        userid: post.UserId\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cont\",\n      children: hasMultipleFiles ? /*#__PURE__*/_jsxDEV(ImageContainer, {\n        children: /*#__PURE__*/_jsxDEV(ImageGallery, {\n          items: images,\n          renderLeftNav: renderLeftNav,\n          renderRightNav: renderRightNav,\n          showPlayButton: false,\n          showFullscreenButton: false,\n          showThumbnails: false,\n          autoPlay: false,\n          disableKeyDown: true,\n          showBullets: true,\n          disableThumbnailScroll: true,\n          disableThumbnailSwipe: true,\n          infinite: false,\n          useBrowserFullscreen: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"image\"\n        //src={imageUrls[0].props.src}\n        ,\n        alt: `Image not found`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"post-footer\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"post-footerIcons\",\n        children: [/*#__PURE__*/_jsxDEV(FavoriteBorderIcon, {\n          onClick: handleLikeClick,\n          style: {\n            color: userLiked ? 'red' : 'inherit'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CommentsPopup, {\n          postId: post.PostId,\n          commentData: post.Comments\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(UserPopup, {\n        title: \"Likes\",\n        data: fetchPostLikes,\n        buttonComponent: /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: 'blue'\n          },\n          children: [likes, \" likes\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 28\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 366,\n    columnNumber: 5\n  }, this);\n}\n_s(Post, \"veWNzw/QjNAPjsdf5wo4AQ+K3iw=\");\n_c = Post;\nvar _c;\n$RefreshReg$(_c, \"Post\");","map":{"version":3,"names":["React","useState","useEffect","CommentsPopup","UserPopup","UserProfileHeader","BlobToImage","ImageCarousel","ImageGallery","styled","ArrowCircleLeftIcon","ArrowCircleRightIcon","FavoriteBorderIcon","formControlLabelClasses","jsxDEV","_jsxDEV","Post","_ref","_s","post","userLiked","setUserLiked","likes","setLikes","Likes","length","hasMultipleFiles","setHasMultipleFiles","maxHeight","maxWidth","images","setImages","largestImageHeight","setLargestImageHeight","userRow","profilepictureblob","ProfilePicture","name","UsersName","userid","UserId","debounceTimeout","console","log","ImageContainer","setImageContainer","Files","fetchImages","result","byteArray","error","adjustedHeights","map","image","aspectRatio","width","height","adjustedHeight","Math","min","parseInt","maxAdjustedHeight","max","imgCont","div","maxImageHeight","handleLikeClick","newLikes","clearTimeout","setTimeout","_JSON$parse","postId","likeUserId","JSON","parse","sessionStorage","getItem","objMap","finalBody","stringify","response","fetch","method","body","headers","fetchPostLikes","testLikesData","userId","profilePictureBlob","renderLeftNav","onClick","disabled","className","children","fileName","_jsxFileName","lineNumber","columnNumber","renderRightNav","items","showPlayButton","showFullscreenButton","showThumbnails","autoPlay","disableKeyDown","showBullets","disableThumbnailScroll","disableThumbnailSwipe","infinite","useBrowserFullscreen","alt","style","color","PostId","commentData","Comments","title","data","buttonComponent","_c","$RefreshReg$"],"sources":["D:/Glenn McKnight/Documents/Github/SocialDynamo/SocialDynamo/Frontend/react-frontend/src/components/post/post.js"],"sourcesContent":["import React, {useState, useEffect} from \"react\";\r\nimport \"./post.css\";\r\n//import \"./files.css\";\r\nimport CommentsPopup from \"../modals/comments-popup\";\r\nimport UserPopup from \"../modals/user-popup\";\r\nimport UserProfileHeader from \"../user-profile-header\";\r\nimport BlobToImage from \"../../util/blob-to-image\";\r\nimport ImageCarousel from \"./image-carousel\";\r\n//import \"react-image-gallery/styles/css/image-gallery.css\";\r\nimport \"./image-gallery.css\";\r\nimport ImageGallery from \"react-image-gallery\";\r\nimport styled from 'styled-components'\r\n\r\nimport ArrowCircleLeftIcon from '@mui/icons-material/ArrowCircleLeft';\r\nimport ArrowCircleRightIcon from '@mui/icons-material/ArrowCircleRight';\r\nimport FavoriteBorderIcon from \"@mui/icons-material/FavoriteBorder\";\r\nimport { formControlLabelClasses } from \"@mui/material\";\r\n\r\nexport default function Post({ post }) {\r\n  const [userLiked, setUserLiked] = useState(false);\r\n  const [likes, setLikes] = useState(post.Likes.length > 0 ? post.Likes : 0);\r\n  const [hasMultipleFiles, setHasMultipleFiles] = useState(false)\r\n\r\n  const maxHeight = \"800px\";\r\n  const maxWidth = \"400px\";\r\n  \r\n  // const images = BlobToImage({ byteArray: post.Files });\r\n\r\n  // const largestImageHeight = Math.min(\r\n  //   images.length > 0 ? Math.max(...images.map(image => image.height)) : 600,\r\n  //   600\r\n  // );\r\n  const [images, setImages] = useState([]);\r\n  const [largestImageHeight, setLargestImageHeight] = useState(maxHeight);\r\n\r\n  const userRow = {\r\n    profilepictureblob: post.ProfilePicture,\r\n    name: post.UsersName,\r\n    userid: post.UserId\r\n  }\r\n  let debounceTimeout;\r\n  \r\n  console.log(`maxWidth: ${maxWidth}, maxHeight: ${maxHeight}, height: ${largestImageHeight}`);\r\n\r\n\r\n  //Loop through once loaded. \r\n  //Don't think it will work due to images not being loaded, still urls. \r\n\r\n  //Set css based on code values\r\n  // const ImageContainer = styled.div`\r\n    \r\n  //   .image-gallery-content,\r\n  //   .image-gallery-image,\r\n  //   .image-gallery-slides\r\n  //   {\r\n  //     width: 100%;\r\n  //     max-width: ${maxWidth}px;\r\n  //     height: ${largestImageHeight}px;\r\n  //     max-height: ${maxHeight}px;\r\n  //     object-fit: contain;\r\n  //   }\r\n    \r\n  //   .image-gallery-slides{\r\n  //     border: 1px solid black\r\n  //   }\r\n  //   `;\r\n\r\n  const [ImageContainer, setImageContainer] =  useState(null);\r\n\r\n  //Initialise multiple files const\r\n  useEffect(() => {\r\n    setHasMultipleFiles(post.Files.length > 1);\r\n\r\n    \r\n\r\n    // const blobResult = BlobToImage({ byteArray: post.Files });\r\n\r\n    // console.log(\"Just checking blobResult after fetching: \" + blobResult);\r\n\r\n\r\n    // setImages(blobResult);\r\n    // const maxImageHeight = Math.max(...images.map(image => image.height));\r\n\r\n    // console.log(\"Just checking height after maxImageHeight: \" + maxImageHeight);\r\n\r\n\r\n    // if (maxImageHeight >= parseInt(maxHeight)) {\r\n    //   setLargestImageHeight(parseInt(maxHeight));\r\n    // }else{\r\n    //   setLargestImageHeight(`${maxImageHeight}px`);\r\n    // }\r\n      \r\n    //console.log(\"Just checking height before blob stuff: \" + images[0].height);\r\n\r\n\r\n    const fetchImages = async () => {\r\n      // const result = await BlobToImage({ byteArray: post.Files });\r\n      // setImages(result);\r\n      try {\r\n        const result = await BlobToImage({ byteArray: post.Files });\r\n        console.log('Fetched images successfully:', result);\r\n        setImages(result);\r\n      } catch (error) {\r\n        console.error('Error fetching images:', error);\r\n        setImages([]); // Ensure that images are set to an empty array in case of an error\r\n      }\r\n    };\r\n\r\n    fetchImages();\r\n\r\n    // console.log(`Max height in useEffect (should be 400px): ${maxHeight}`);\r\n\r\n    // const largestImage = () => {\r\n    //   // const result = Math.min(\r\n    //   //   images.length > 0 ? Math.max(...images.map(image => image.height)) : 0,\r\n    //   //   parseInt(maxHeight));\r\n\r\n\r\n    //   // if (images.length > 0) {\r\n    //   //   const maxCollectionHeight = Math.max(...images.map(image => image.height));\r\n    //   //   result = maxCollectionHeight <= parseInt(maxHeight) ? maxCollectionHeight : parseInt(maxHeight);\r\n    //   // } else {\r\n    //   //   result = parseInt(maxHeight);\r\n    //   // }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    //   // console.log(`Max height is: ${result}`);\r\n    //   // setLargestImageHeight(result);\r\n\r\n    //   console.log(`Images length: ${images.length}`);\r\n\r\n    //   if (images.length > 0) {\r\n    //     const maxImageHeight = Math.max(...images.map(image => image.height));\r\n    \r\n    //     if (maxImageHeight <= parseInt(maxHeight)) {\r\n    //       console.log(`Setting height to actual image height: ${maxImageHeight}`);\r\n    //       setLargestImageHeight(`${maxImageHeight}px`);\r\n    //     } else {\r\n    //       console.log(`Setting height to maxHeight: ${maxHeight}`);\r\n    //       setLargestImageHeight(maxHeight);\r\n    //     }\r\n    //   } else {\r\n    //     console.log(`Setting height to default maxHeight: ${maxHeight}`);\r\n    //     setLargestImageHeight(maxHeight);\r\n    //   }\r\n    // };\r\n\r\n    // //largestImage();\r\n\r\n    // const fetchDataAndCalculate = () => {\r\n    //   console.log(\"In new fetch method, images.length: \" + images.length);\r\n    //   fetchImages();\r\n    //   largestImage();\r\n    // };\r\n  \r\n    // fetchDataAndCalculate();\r\n\r\n\r\n    \r\n\r\n\r\n\r\n  }, [post.Files.length]);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    \r\n      // const maxImageHeight = Math.max(...images.map(image => image.height));\r\n\r\n      // if (maxImageHeight <= parseInt(maxHeight)) {\r\n      //   setLargestImageHeight(`${maxImageHeight}px`);\r\n      // } else {\r\n      //   setLargestImageHeight(maxHeight);\r\n      // }\r\n    \r\n      const adjustedHeights = images.map(image => {\r\n        const aspectRatio = image.width / image.height;\r\n        const adjustedHeight = Math.min(maxWidth / aspectRatio, parseInt(maxHeight));\r\n        return Math.min(adjustedHeight, parseInt(maxHeight));\r\n      });\r\n  \r\n      // Find the maximum adjusted height among all images\r\n      const maxAdjustedHeight = Math.max(...adjustedHeights);\r\n  \r\n      setLargestImageHeight(`${maxAdjustedHeight}px`);\r\n\r\n      console.log(\"HERE largest final image height: \" + maxAdjustedHeight);\r\n\r\n\r\n      //Set\r\n      const imgCont = styled.div`    \r\n        .image-gallery-content,\r\n        .image-gallery-image,\r\n        .image-gallery-slides\r\n        {\r\n          width: 100%;\r\n          max-width: ${maxWidth}px;\r\n          height: ${maxImageHeight}px;\r\n          max-height: ${maxHeight}px;\r\n          object-fit: contain;\r\n        }\r\n        \r\n        .image-gallery-slides{\r\n          border: 1px solid black\r\n        }\r\n        `;\r\n\r\n      setImageContainer(imgCont);\r\n\r\n  }, [images]);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  //Handle post like\r\n  const handleLikeClick = () => {\r\n    setUserLiked(!userLiked);\r\n\r\n    // Update the local state of likes\r\n    const newLikes = userLiked ? likes - 1 : likes + 1;\r\n    setLikes(newLikes);\r\n    \r\n    if (debounceTimeout) {\r\n      clearTimeout(debounceTimeout);\r\n    }\r\n\r\n    debounceTimeout = setTimeout(async () => {            \r\n      const postId = post.postId;\r\n      const likeUserId = JSON.parse(sessionStorage.getItem('userId'))?.UserId || null;\r\n      const objMap = { postId, likeUserId };\r\n      const finalBody = JSON.stringify(objMap);\r\n\r\n      //Send data\r\n      const response = await fetch('http://20.49.168.20:80/posts/likepost', {\r\n        method: 'PUT',\r\n        body: finalBody,\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n        },\r\n      });\r\n    }, 300);\r\n  };\r\n\r\n  //Fetch current likes from API\r\n  const fetchPostLikes = async () => {\r\n    // const userIds = post.likes.map((like) => like.LikeUserId);\r\n      \r\n    // const objMap = { userIds };\r\n    // const finalBody = JSON.stringify(objMap);\r\n\r\n    // //Send data              \r\n    // const response = await fetch('http://20.49.168.20:80/account/Profiles', {\r\n    //   method: 'PUT',\r\n    //   body: finalBody,\r\n    //   headers: {\r\n    //     'Content-Type': 'application/json',\r\n    //   },\r\n    // });\r\n\r\n    // const data = await response.json();\r\n\r\n    // //Map response and update\r\n    // const processedData = post.likes.map((item, index) => ({\r\n    //   userId: item.LikeUserId,\r\n    //   name: data[index].forename + ' ' + data[index].surname,\r\n    //   profilePictureBlob: data[index].profilePictureBlob\r\n    // }));      \r\n    \r\n    // if(userLiked) processedData.unshift(userRow);\r\n\r\n    // return processedData;\r\n    const testLikesData = [\r\n    {\r\n      userId: 1,\r\n      name: 'John Doe',\r\n      profilePictureBlob: null\r\n    },\r\n    {\r\n      userId: 2,\r\n      name: 'Jane Smith',\r\n      profilePictureBlob: null\r\n    },\r\n    {\r\n      userId: 3,\r\n      name: 'Bob Johnson',\r\n      profilePictureBlob: null\r\n    }];\r\n\r\n    return testLikesData;\r\n  };\r\n\r\n  \r\n  console.log(images);\r\n\r\n\r\n  //  //\r\n  //Set max height and max width with !important?\r\n  //Set width with !important?\r\n  //  Might not need to since the div wraps both the gallery and the single image. \r\n  //All width should be constant. \r\n  //Should resize images to this width, mainaining aspect ratio, maybe in blob-to-image\r\n  //Remember to set background\r\n\r\n  //  //\r\n  //Ensure image is centred. \r\n\r\n  //  //\r\n  //Could try only defining width, should maintain aspect ratio of height. \r\n  //Will just need to set height to maximum image size. \r\n  //Scale everything else up to fit width\r\n\r\n  //  //\r\n  //Could just scale everything to fit the biggest height inside 598px? \r\n  //\r\n\r\n\r\n  //\r\n  // Could scale everything up within 50 - 100px?\r\n  //\r\n\r\n  //Custom rendering for left nav icon\r\n  function renderLeftNav(onClick, disabled) {\r\n    return (\r\n      <button\r\n        className='image-gallery-left-nav'\r\n        disabled={disabled}\r\n        onClick={onClick}>\r\n          <ArrowCircleLeftIcon className='LeftIcon'/>\r\n      </button>\r\n    )\r\n  };\r\n\r\n  //Custom render for right nav icon\r\n  function renderRightNav(onClick, disabled) {\r\n    return (\r\n      <button        \r\n        className='image-gallery-right-nav'\r\n        disabled={disabled}\r\n        onClick={onClick}>\r\n          <ArrowCircleRightIcon className='RightIcon'/>\r\n      </button>\r\n    )\r\n  }\r\n    \r\n  console.log(\"Has multiple files: \" + hasMultipleFiles);\r\n  return (\r\n    <div className=\"post\">\r\n      <div className=\"post-header\">             \r\n        <UserProfileHeader profilepictureblob={post.ProfilePicture} name={post.UsersName} userid={post.UserId}/>           \r\n      </div>\r\n      {/* <div className=\"post-image\"> */}\r\n      <div className=\"cont\">\r\n        {hasMultipleFiles ? (\r\n          <ImageContainer>\r\n            <ImageGallery items={images} \r\n                renderLeftNav={renderLeftNav}\r\n                renderRightNav={renderRightNav}\r\n                showPlayButton={false}\r\n                showFullscreenButton={false}\r\n                showThumbnails={false}\r\n                autoPlay={false}\r\n                disableKeyDown={true}\r\n                showBullets={true}\r\n                disableThumbnailScroll={true}\r\n                disableThumbnailSwipe={true}\r\n                infinite={false}\r\n                useBrowserFullscreen={false}\r\n                />\r\n            </ImageContainer>\r\n        ) : (\r\n          <img\r\n                className=\"image\"\r\n                //src={imageUrls[0].props.src}\r\n                alt={`Image not found`}\r\n            />      \r\n        )}\r\n      </div>     \r\n      <div className=\"post-footer\">\r\n        <div className=\"post-footerIcons\">          \r\n          <FavoriteBorderIcon \r\n              onClick={handleLikeClick} \r\n              style={{ color: userLiked ? 'red' : 'inherit' }} \r\n          />\r\n          <CommentsPopup postId={post.PostId} commentData={post.Comments}/>                   \r\n        </div>\r\n        {/* <UserPopup\r\n          title={'Likes'}\r\n          data={fetchPostLikes}\r\n          buttonText={<span style={{ color: 'blue' }}>{likes} likes</span>}\r\n        /> */}\r\n        <UserPopup\r\n          title=\"Likes\"\r\n          data={fetchPostLikes}\r\n          buttonComponent={<span style={{ color: 'blue' }}>{likes} likes</span>}\r\n        />\r\n      </div>        \r\n    </div>\r\n  );  \r\n}"],"mappings":";;AAAA,OAAOA,KAAK,IAAGC,QAAQ,EAAEC,SAAS,QAAO,OAAO;AAChD,OAAO,YAAY;AACnB;AACA,OAAOC,aAAa,MAAM,0BAA0B;AACpD,OAAOC,SAAS,MAAM,sBAAsB;AAC5C,OAAOC,iBAAiB,MAAM,wBAAwB;AACtD,OAAOC,WAAW,MAAM,0BAA0B;AAClD,OAAOC,aAAa,MAAM,kBAAkB;AAC5C;AACA,OAAO,qBAAqB;AAC5B,OAAOC,YAAY,MAAM,qBAAqB;AAC9C,OAAOC,MAAM,MAAM,mBAAmB;AAEtC,OAAOC,mBAAmB,MAAM,qCAAqC;AACrE,OAAOC,oBAAoB,MAAM,sCAAsC;AACvE,OAAOC,kBAAkB,MAAM,oCAAoC;AACnE,SAASC,uBAAuB,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExD,eAAe,SAASC,IAAIA,CAAAC,IAAA,EAAW;EAAAC,EAAA;EAAA,IAAV;IAAEC;EAAK,CAAC,GAAAF,IAAA;EACnC,MAAM,CAACG,SAAS,EAAEC,YAAY,CAAC,GAAGpB,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACqB,KAAK,EAAEC,QAAQ,CAAC,GAAGtB,QAAQ,CAACkB,IAAI,CAACK,KAAK,CAACC,MAAM,GAAG,CAAC,GAAGN,IAAI,CAACK,KAAK,GAAG,CAAC,CAAC;EAC1E,MAAM,CAACE,gBAAgB,EAAEC,mBAAmB,CAAC,GAAG1B,QAAQ,CAAC,KAAK,CAAC;EAE/D,MAAM2B,SAAS,GAAG,OAAO;EACzB,MAAMC,QAAQ,GAAG,OAAO;;EAExB;;EAEA;EACA;EACA;EACA;EACA,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAG9B,QAAQ,CAAC,EAAE,CAAC;EACxC,MAAM,CAAC+B,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGhC,QAAQ,CAAC2B,SAAS,CAAC;EAEvE,MAAMM,OAAO,GAAG;IACdC,kBAAkB,EAAEhB,IAAI,CAACiB,cAAc;IACvCC,IAAI,EAAElB,IAAI,CAACmB,SAAS;IACpBC,MAAM,EAAEpB,IAAI,CAACqB;EACf,CAAC;EACD,IAAIC,eAAe;EAEnBC,OAAO,CAACC,GAAG,CAAE,aAAYd,QAAS,gBAAeD,SAAU,aAAYI,kBAAmB,EAAC,CAAC;;EAG5F;EACA;;EAEA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;;EAEA,MAAM,CAACY,cAAc,EAAEC,iBAAiB,CAAC,GAAI5C,QAAQ,CAAC,IAAI,CAAC;;EAE3D;EACAC,SAAS,CAAC,MAAM;IACdyB,mBAAmB,CAACR,IAAI,CAAC2B,KAAK,CAACrB,MAAM,GAAG,CAAC,CAAC;;IAI1C;;IAEA;;IAGA;IACA;;IAEA;;IAGA;IACA;IACA;IACA;IACA;;IAEA;;IAGA,MAAMsB,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B;MACA;MACA,IAAI;QACF,MAAMC,MAAM,GAAG,MAAM1C,WAAW,CAAC;UAAE2C,SAAS,EAAE9B,IAAI,CAAC2B;QAAM,CAAC,CAAC;QAC3DJ,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEK,MAAM,CAAC;QACnDjB,SAAS,CAACiB,MAAM,CAAC;MACnB,CAAC,CAAC,OAAOE,KAAK,EAAE;QACdR,OAAO,CAACQ,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;QAC9CnB,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;MACjB;IACF,CAAC;;IAEDgB,WAAW,CAAC,CAAC;;IAEb;;IAEA;IACA;IACA;IACA;;IAGA;IACA;IACA;IACA;IACA;IACA;;IAOA;IACA;;IAEA;;IAEA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;;IAEA;IACA;IACA;IACA;IACA;;IAEA;EAOF,CAAC,EAAE,CAAC5B,IAAI,CAAC2B,KAAK,CAACrB,MAAM,CAAC,CAAC;EAWvBvB,SAAS,CAAC,MAAM;IAEZ;;IAEA;IACA;IACA;IACA;IACA;;IAEA,MAAMiD,eAAe,GAAGrB,MAAM,CAACsB,GAAG,CAACC,KAAK,IAAI;MAC1C,MAAMC,WAAW,GAAGD,KAAK,CAACE,KAAK,GAAGF,KAAK,CAACG,MAAM;MAC9C,MAAMC,cAAc,GAAGC,IAAI,CAACC,GAAG,CAAC9B,QAAQ,GAAGyB,WAAW,EAAEM,QAAQ,CAAChC,SAAS,CAAC,CAAC;MAC5E,OAAO8B,IAAI,CAACC,GAAG,CAACF,cAAc,EAAEG,QAAQ,CAAChC,SAAS,CAAC,CAAC;IACtD,CAAC,CAAC;;IAEF;IACA,MAAMiC,iBAAiB,GAAGH,IAAI,CAACI,GAAG,CAAC,GAAGX,eAAe,CAAC;IAEtDlB,qBAAqB,CAAE,GAAE4B,iBAAkB,IAAG,CAAC;IAE/CnB,OAAO,CAACC,GAAG,CAAC,mCAAmC,GAAGkB,iBAAiB,CAAC;;IAGpE;IACA,MAAME,OAAO,GAAGtD,MAAM,CAACuD,GAAI;AACjC;AACA;AACA;AACA;AACA;AACA,uBAAuBnC,QAAS;AAChC,oBAAoBoC,cAAe;AACnC,wBAAwBrC,SAAU;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;IAEHiB,iBAAiB,CAACkB,OAAO,CAAC;EAE9B,CAAC,EAAE,CAACjC,MAAM,CAAC,CAAC;;EAYZ;EACA,MAAMoC,eAAe,GAAGA,CAAA,KAAM;IAC5B7C,YAAY,CAAC,CAACD,SAAS,CAAC;;IAExB;IACA,MAAM+C,QAAQ,GAAG/C,SAAS,GAAGE,KAAK,GAAG,CAAC,GAAGA,KAAK,GAAG,CAAC;IAClDC,QAAQ,CAAC4C,QAAQ,CAAC;IAElB,IAAI1B,eAAe,EAAE;MACnB2B,YAAY,CAAC3B,eAAe,CAAC;IAC/B;IAEAA,eAAe,GAAG4B,UAAU,CAAC,YAAY;MAAA,IAAAC,WAAA;MACvC,MAAMC,MAAM,GAAGpD,IAAI,CAACoD,MAAM;MAC1B,MAAMC,UAAU,GAAG,EAAAF,WAAA,GAAAG,IAAI,CAACC,KAAK,CAACC,cAAc,CAACC,OAAO,CAAC,QAAQ,CAAC,CAAC,cAAAN,WAAA,uBAA5CA,WAAA,CAA8C9B,MAAM,KAAI,IAAI;MAC/E,MAAMqC,MAAM,GAAG;QAAEN,MAAM;QAAEC;MAAW,CAAC;MACrC,MAAMM,SAAS,GAAGL,IAAI,CAACM,SAAS,CAACF,MAAM,CAAC;;MAExC;MACA,MAAMG,QAAQ,GAAG,MAAMC,KAAK,CAAC,uCAAuC,EAAE;QACpEC,MAAM,EAAE,KAAK;QACbC,IAAI,EAAEL,SAAS;QACfM,OAAO,EAAE;UACL,cAAc,EAAE;QACpB;MACF,CAAC,CAAC;IACJ,CAAC,EAAE,GAAG,CAAC;EACT,CAAC;;EAED;EACA,MAAMC,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC;;IAEA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;;IAEA;IACA;IACA;IACA;IACA;IACA;;IAEA;;IAEA;IACA,MAAMC,aAAa,GAAG,CACtB;MACEC,MAAM,EAAE,CAAC;MACTlD,IAAI,EAAE,UAAU;MAChBmD,kBAAkB,EAAE;IACtB,CAAC,EACD;MACED,MAAM,EAAE,CAAC;MACTlD,IAAI,EAAE,YAAY;MAClBmD,kBAAkB,EAAE;IACtB,CAAC,EACD;MACED,MAAM,EAAE,CAAC;MACTlD,IAAI,EAAE,aAAa;MACnBmD,kBAAkB,EAAE;IACtB,CAAC,CAAC;IAEF,OAAOF,aAAa;EACtB,CAAC;EAGD5C,OAAO,CAACC,GAAG,CAACb,MAAM,CAAC;;EAGnB;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;;EAEA;EACA;EACA;EACA;;EAEA;EACA;EACA;;EAGA;EACA;EACA;;EAEA;EACA,SAAS2D,aAAaA,CAACC,OAAO,EAAEC,QAAQ,EAAE;IACxC,oBACE5E,OAAA;MACE6E,SAAS,EAAC,wBAAwB;MAClCD,QAAQ,EAAEA,QAAS;MACnBD,OAAO,EAAEA,OAAQ;MAAAG,QAAA,eACf9E,OAAA,CAACL,mBAAmB;QAACkF,SAAS,EAAC;MAAU;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAC;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACvC,CAAC;EAEb;EAAC;;EAED;EACA,SAASC,cAAcA,CAACR,OAAO,EAAEC,QAAQ,EAAE;IACzC,oBACE5E,OAAA;MACE6E,SAAS,EAAC,yBAAyB;MACnCD,QAAQ,EAAEA,QAAS;MACnBD,OAAO,EAAEA,OAAQ;MAAAG,QAAA,eACf9E,OAAA,CAACJ,oBAAoB;QAACiF,SAAS,EAAC;MAAW;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAC;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACzC,CAAC;EAEb;EAEAvD,OAAO,CAACC,GAAG,CAAC,sBAAsB,GAAGjB,gBAAgB,CAAC;EACtD,oBACEX,OAAA;IAAK6E,SAAS,EAAC,MAAM;IAAAC,QAAA,gBACnB9E,OAAA;MAAK6E,SAAS,EAAC,aAAa;MAAAC,QAAA,eAC1B9E,OAAA,CAACV,iBAAiB;QAAC8B,kBAAkB,EAAEhB,IAAI,CAACiB,cAAe;QAACC,IAAI,EAAElB,IAAI,CAACmB,SAAU;QAACC,MAAM,EAAEpB,IAAI,CAACqB;MAAO;QAAAsD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAC;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACrG,CAAC,eAENlF,OAAA;MAAK6E,SAAS,EAAC,MAAM;MAAAC,QAAA,EAClBnE,gBAAgB,gBACfX,OAAA,CAAC6B,cAAc;QAAAiD,QAAA,eACb9E,OAAA,CAACP,YAAY;UAAC2F,KAAK,EAAErE,MAAO;UACxB2D,aAAa,EAAEA,aAAc;UAC7BS,cAAc,EAAEA,cAAe;UAC/BE,cAAc,EAAE,KAAM;UACtBC,oBAAoB,EAAE,KAAM;UAC5BC,cAAc,EAAE,KAAM;UACtBC,QAAQ,EAAE,KAAM;UAChBC,cAAc,EAAE,IAAK;UACrBC,WAAW,EAAE,IAAK;UAClBC,sBAAsB,EAAE,IAAK;UAC7BC,qBAAqB,EAAE,IAAK;UAC5BC,QAAQ,EAAE,KAAM;UAChBC,oBAAoB,EAAE;QAAM;UAAAf,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC3B;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACU,CAAC,gBAEnBlF,OAAA;QACM6E,SAAS,EAAC;QACV;QAAA;QACAkB,GAAG,EAAG;MAAiB;QAAAhB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC1B;IACJ;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,eACNlF,OAAA;MAAK6E,SAAS,EAAC,aAAa;MAAAC,QAAA,gBAC1B9E,OAAA;QAAK6E,SAAS,EAAC,kBAAkB;QAAAC,QAAA,gBAC/B9E,OAAA,CAACH,kBAAkB;UACf8E,OAAO,EAAExB,eAAgB;UACzB6C,KAAK,EAAE;YAAEC,KAAK,EAAE5F,SAAS,GAAG,KAAK,GAAG;UAAU;QAAE;UAAA0E,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnD,CAAC,eACFlF,OAAA,CAACZ,aAAa;UAACoE,MAAM,EAAEpD,IAAI,CAAC8F,MAAO;UAACC,WAAW,EAAE/F,IAAI,CAACgG;QAAS;UAAArB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9D,CAAC,eAMNlF,OAAA,CAACX,SAAS;QACRgH,KAAK,EAAC,OAAO;QACbC,IAAI,EAAEhC,cAAe;QACrBiC,eAAe,eAAEvG,OAAA;UAAMgG,KAAK,EAAE;YAAEC,KAAK,EAAE;UAAO,CAAE;UAAAnB,QAAA,GAAEvE,KAAK,EAAC,QAAM;QAAA;UAAAwE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM;MAAE;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAC/E,EAAA,CA/YuBF,IAAI;AAAAuG,EAAA,GAAJvG,IAAI;AAAA,IAAAuG,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}